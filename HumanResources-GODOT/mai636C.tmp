[gd_scene load_steps=27 format=3 uid="uid://dtl107bvdp3l2"]

[ext_resource type="Script" path="res://main.gd" id="1_7avpk"]
[ext_resource type="PackedScene" uid="uid://dnude20kkwqbr" path="res://player.tscn" id="1_bfkgm"]
[ext_resource type="SpriteFrames" uid="uid://c0nhljs2uubuc" path="res://textbox_test.tres" id="2_svert"]
[ext_resource type="Script" path="res://SwordHitbox.gd" id="3_n6fjm"]
[ext_resource type="Script" path="res://dialogSystem/scripts/textbox.gd" id="4_07pqn"]
[ext_resource type="Script" path="res://enemy.gd" id="4_wbgm3"]
[ext_resource type="FontFile" uid="uid://hyle3ada7prk" path="res://fonts/CourierPrime-BoldItalic.ttf" id="5_bvye2"]
[ext_resource type="FontFile" uid="uid://dfriddtlr78g1" path="res://fonts/CourierPrime-Regular.ttf" id="5_x5upw"]
[ext_resource type="Script" path="res://dialogSystem/scripts/option.gd" id="7_gb3p3"]
[ext_resource type="PackedScene" uid="uid://desmdk118m5h2" path="res://test_npc.tscn" id="9_ehj62"]
[ext_resource type="SpriteFrames" uid="uid://ctmxroxg4woxd" path="res://art/2D Sprites/character_portraits/example/example.tres" id="9_ivt47"]
[ext_resource type="Script" path="res://dialogSystem/scripts/characterPortraits.gd" id="10_5qi0k"]
[ext_resource type="SpriteFrames" uid="uid://bygl77t1d27x8" path="res://indicator.tres" id="11_pimdg"]
[ext_resource type="Script" path="res://npc_basic.gd" id="12_4jmty"]
[ext_resource type="Script" path="res://dialogSystem/scripts/option_indicator.gd" id="12_8aqil"]
[ext_resource type="SpriteFrames" uid="uid://cgwrv62lxykmk" path="res://option_indicator.tres" id="12_snfd7"]
[ext_resource type="FontFile" uid="uid://c102fu0xf67kd" path="res://fonts/CourierPrime-Bold.ttf" id="22_mme0b"]
[ext_resource type="FontFile" uid="uid://cj7c8xs0yi4mj" path="res://fonts/CourierPrime-Italic.ttf" id="23_esx6h"]
[ext_resource type="Script" path="res://Stamina.gd" id="26_43b6n"]
[ext_resource type="Script" path="res://Health.gd" id="27_id5rx"]
[ext_resource type="Script" path="res://Resources.gd" id="29_rfic1"]

[sub_resource type="BoxShape3D" id="BoxShape3D_bb4f4"]
size = Vector3(60, 2, 60)

[sub_resource type="BoxMesh" id="BoxMesh_secun"]
size = Vector3(60, 2, 60)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_dhi2g"]
albedo_color = Color(1, 0, 0, 1)

[sub_resource type="SphereMesh" id="SphereMesh_hvjwi"]
material = SubResource("StandardMaterial3D_dhi2g")

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_40rct"]
points = PackedVector3Array(0.457871, 0.198079, 0.0157824, -0.48874, -0.0916874, -0.0451868, -0.471509, -0.137027, -0.0907015, 0.0763591, -0.333275, 0.364179, 0.136569, -0.332425, -0.346906, -0.151617, 0.471982, -0.0602459, -0.105347, 0.211936, 0.43966, -0.0450169, 0.198098, -0.456416, 0.409077, -0.151168, 0.242516, -0.271376, -0.377761, 0.181871, 0.41148, -0.075981, -0.27324, 0.198197, -0.456161, -0.044931, -0.240641, -0.331674, -0.285768, 0.227137, 0.25672, 0.363041, 0.227522, 0.423604, -0.135488, -0.37899, 0.0607022, 0.319462, -0.406747, 0.181049, -0.225691, -0.0146313, -0.0917695, 0.490229, -0.377855, 0.302793, 0.121712, 0.0462323, 0.456011, 0.198185, -0.227464, -0.0607863, -0.440348, 0.228455, 0.0607228, -0.439887, -0.0911376, -0.489246, -0.045174, 0.441865, -0.228216, -0.0449581, 0.317179, 0.241214, -0.300812, -0.0448487, 0.394737, -0.302955, -0.316348, -0.196222, 0.332551, 0.198442, -0.0304293, 0.457237, 0.0614714, -0.152246, -0.471307, 0.363089, 0.256708, 0.227079, 0.152134, -0.439489, 0.182379, -0.210725, 0.362276, 0.27223)

[node name="Main" type="Node"]
script = ExtResource("1_7avpk")

[node name="Player_Pivot_ProtagTestLoopMaybe_metarig_Skeleton3D_BoneAttachment3D_Amoray-Note1_gold_stuff_polySurface2#StaticBody3D" type="StaticBody3D" parent="." groups=["Weapon_Hitboxes"]]
script = ExtResource("3_n6fjm")
metadata/parentMesh = NodePath("../../..")
metadata/baseDamage = 0

[node name="Ground" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)
collision_layer = 4
collision_mask = 0

[node name="CollisionShape3D" type="CollisionShape3D" parent="Ground"]
shape = SubResource("BoxShape3D_bb4f4")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Ground"]
mesh = SubResource("BoxMesh_secun")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.14116, 0.989987, 0, -0.989987, 0.14116, 0, 12.4772, 0)
shadow_enabled = true

[node name="Player" parent="." instance=ExtResource("1_bfkgm")]
transform = Transform3D(0.415411, 0, 0, 0, 0.415411, 0, 0, 0, 0.415411, 0, 0, 0)
collision_mask = 6

[node name="PlayerView" type="Camera3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 0.573577, 0.819152, 0, -0.819152, 0.573577, 0, 15, 12)
projection = 1
current = true
size = 19.0

[node name="cameraTimer" type="Timer" parent="Player/PlayerView"]
wait_time = 7.0
one_shot = true

[node name="test npc" parent="." groups=["NPC", "interactable"] instance=ExtResource("9_ehj62")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -9.16178, 0.262092, -6.33648)
collision_layer = 2
collision_mask = 3
script = ExtResource("12_4jmty")
metadata/attitude = 0

[node name="test npc2" parent="." groups=["NPC", "interactable"] instance=ExtResource("9_ehj62")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 9.65562, 0.262092, -6.33648)
collision_layer = 2
collision_mask = 3
script = ExtResource("12_4jmty")
metadata/attitude = 0

[node name="enemyTest" type="CharacterBody3D" parent="." groups=["melee_enemies"]]
transform = Transform3D(-2.30138e-07, -5.26495, 0, 5.26495, -2.30138e-07, 0, 0, 0, 5.26495, 0.297625, 3.95579, -6.10371)
collision_layer = 2
collision_mask = 3
script = ExtResource("4_wbgm3")
metadata/health = 30

[node name="MeshInstance3D2" type="MeshInstance3D" parent="enemyTest"]
transform = Transform3D(1, 3.55271e-15, 0, -3.55271e-15, 1, 0, 0, 0, 1, 0, 0, 0)
layers = 3
mesh = SubResource("SphereMesh_hvjwi")
skeleton = NodePath("")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="enemyTest"]
transform = Transform3D(1.19998, 7.10543e-15, 0, -7.10543e-15, 1.19998, 0, 0, 0, 1.19998, 0, 0, 0)
shape = SubResource("ConvexPolygonShape3D_40rct")

[node name="UserInterface" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="Health" type="Label" parent="UserInterface"]
layout_mode = 0
offset_left = 27.0
offset_top = 22.0
offset_right = 125.0
offset_bottom = 45.0
theme_override_colors/font_color = Color(0, 0, 0, 1)
theme_override_font_sizes/font_size = 30
text = "HEALTH: 100"
script = ExtResource("27_id5rx")

[node name="Stamina" type="Label" parent="UserInterface"]
layout_mode = 0
offset_left = 29.0
offset_top = 53.0
offset_right = 231.0
offset_bottom = 95.0
theme_override_colors/font_color = Color(0, 0, 0, 1)
theme_override_font_sizes/font_size = 30
text = "STAMINA: 100"
script = ExtResource("26_43b6n")

[node name="Resources" type="Label" parent="UserInterface"]
layout_mode = 0
offset_left = 973.0
offset_top = 526.0
offset_right = 1086.0
offset_bottom = 589.0
theme_override_colors/font_color = Color(0, 0, 0, 1)
theme_override_font_sizes/font_size = 45
text = "HR: 0"
script = ExtResource("29_rfic1")

[node name="TextInterface" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="textbox" type="AnimatedSprite2D" parent="TextInterface"]
visible = false
texture_filter = 1
texture_repeat = 2
position = Vector2(570, 532.25)
scale = Vector2(22.375, 4.09375)
sprite_frames = ExtResource("2_svert")
animation = &"textbox_test"
script = ExtResource("4_07pqn")

[node name="Timer" type="Timer" parent="TextInterface/textbox"]

[node name="Indicator" type="AnimatedSprite2D" parent="TextInterface/textbox"]
visible = false
position = Vector2(-2.50279, -32.7939)
scale = Vector2(0.03, 0.114)
sprite_frames = ExtResource("11_pimdg")

[node name="option_indicator" type="AnimatedSprite2D" parent="TextInterface/textbox"]
visible = false
top_level = true
texture_filter = 1
position = Vector2(565, 342)
scale = Vector2(0.594792, 0.5)
sprite_frames = ExtResource("12_snfd7")
script = ExtResource("12_8aqil")

[node name="indicator_timer" type="Timer" parent="TextInterface/textbox/option_indicator"]

[node name="SpeakerSprite" type="Control" parent="TextInterface"]
clip_children = 1
clip_contents = true
layout_mode = 1
anchor_left = 0.5
anchor_top = 5.527
anchor_right = 5.645
anchor_bottom = 16.478
grow_horizontal = 2
grow_vertical = 2

[node name="speaker_portrait" type="AnimatedSprite2D" parent="TextInterface/SpeakerSprite"]
visible = false
z_index = -3
sprite_frames = ExtResource("9_ivt47")
animation = &"angry"
centered = false
script = ExtResource("10_5qi0k")

[node name="ResponseSprite" type="Control" parent="TextInterface"]
clip_children = 1
clip_contents = true
layout_mode = 1
anchor_left = 23.5
anchor_top = 5.527
anchor_right = 28.109
anchor_bottom = 16.478
offset_top = -1.52588e-05
offset_right = -0.000854492
grow_horizontal = 2
grow_vertical = 2

[node name="response_portrait" type="AnimatedSprite2D" parent="TextInterface/ResponseSprite"]
visible = false
z_index = -3
sprite_frames = ExtResource("9_ivt47")
animation = &"angry"
centered = false
script = ExtResource("10_5qi0k")

[node name="speaker" type="RichTextLabel" parent="TextInterface"]
visible = false
texture_filter = 1
clip_contents = false
layout_mode = 1
anchors_preset = -1
anchor_left = 1.0
anchor_top = 9.76
anchor_right = 27.235
anchor_bottom = 10.734
offset_top = 2.0
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(-152.16, 87.88)
theme_override_colors/default_color = Color(1, 1, 1, 1)
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 20
theme_override_fonts/normal_font = ExtResource("5_x5upw")
theme_override_fonts/bold_font = ExtResource("22_mme0b")
theme_override_fonts/italics_font = ExtResource("23_esx6h")
theme_override_fonts/bold_italics_font = ExtResource("5_bvye2")
theme_override_font_sizes/normal_font_size = 50
theme_override_font_sizes/bold_font_size = 50
theme_override_font_sizes/italics_font_size = 50
theme_override_font_sizes/bold_italics_font_size = 50
theme_override_font_sizes/mono_font_size = 50
bbcode_enabled = true
text = "[b][i]SPEAKER[/i][/b]"
scroll_active = false

[node name="dialog" type="RichTextLabel" parent="TextInterface"]
visible = false
texture_filter = 1
layout_mode = 1
anchors_preset = -1
anchor_left = 1.529
anchor_top = 11.203
anchor_right = 27.235
anchor_bottom = 15.37
grow_horizontal = 2
grow_vertical = 2
theme_override_colors/default_color = Color(1, 1, 1, 1)
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 10
theme_override_fonts/normal_font = ExtResource("5_x5upw")
theme_override_fonts/bold_font = ExtResource("22_mme0b")
theme_override_fonts/italics_font = ExtResource("23_esx6h")
theme_override_fonts/bold_italics_font = ExtResource("5_bvye2")
theme_override_font_sizes/normal_font_size = 30
theme_override_font_sizes/bold_font_size = 30
theme_override_font_sizes/italics_font_size = 30
theme_override_font_sizes/bold_italics_font_size = 30
theme_override_font_sizes/mono_font_size = 30
text = "sdfsfdsfsdfsdsdffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"
scroll_active = false

[node name="option1" type="RichTextLabel" parent="TextInterface"]
visible = false
texture_filter = 1
layout_mode = 1
anchors_preset = -1
anchor_left = 1.529
anchor_top = 11.203
anchor_right = 27.235
anchor_bottom = 12.016
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(-152.16, 87.88)
theme_override_colors/default_color = Color(1, 1, 1, 1)
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 10
theme_override_fonts/normal_font = ExtResource("5_x5upw")
theme_override_fonts/bold_font = ExtResource("22_mme0b")
theme_override_fonts/italics_font = ExtResource("23_esx6h")
theme_override_fonts/bold_italics_font = ExtResource("5_bvye2")
theme_override_font_sizes/normal_font_size = 30
theme_override_font_sizes/bold_font_size = 30
theme_override_font_sizes/italics_font_size = 30
theme_override_font_sizes/bold_italics_font_size = 30
theme_override_font_sizes/mono_font_size = 30
text = "sdfsfdsfsdfsd"
scroll_active = false
scroll_following = true
script = ExtResource("7_gb3p3")
metadata/index = 1

[node name="option2" type="RichTextLabel" parent="TextInterface"]
visible = false
texture_filter = 1
layout_mode = 1
anchors_preset = -1
anchor_left = 1.529
anchor_top = 12.203
anchor_right = 27.235
anchor_bottom = 13.016
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(-152.16, 87.88)
theme_override_colors/default_color = Color(1, 1, 1, 1)
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 10
theme_override_fonts/normal_font = ExtResource("5_x5upw")
theme_override_fonts/bold_font = ExtResource("22_mme0b")
theme_override_fonts/italics_font = ExtResource("23_esx6h")
theme_override_fonts/bold_italics_font = ExtResource("5_bvye2")
theme_override_font_sizes/normal_font_size = 30
theme_override_font_sizes/bold_font_size = 30
theme_override_font_sizes/italics_font_size = 30
theme_override_font_sizes/bold_italics_font_size = 30
theme_override_font_sizes/mono_font_size = 30
text = "sdfsfdsfsdfsd"
scroll_active = false
script = ExtResource("7_gb3p3")
metadata/index = 2

[node name="option3" type="RichTextLabel" parent="TextInterface"]
visible = false
texture_filter = 1
layout_mode = 1
anchors_preset = -1
anchor_left = 1.529
anchor_top = 13.203
anchor_right = 27.235
anchor_bottom = 14.203
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(-152.16, 87.88)
theme_override_colors/default_color = Color(1, 1, 1, 1)
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 10
theme_override_fonts/normal_font = ExtResource("5_x5upw")
theme_override_fonts/bold_font = ExtResource("22_mme0b")
theme_override_fonts/italics_font = ExtResource("23_esx6h")
theme_override_fonts/bold_italics_font = ExtResource("5_bvye2")
theme_override_font_sizes/normal_font_size = 30
theme_override_font_sizes/bold_font_size = 30
theme_override_font_sizes/italics_font_size = 30
theme_override_font_sizes/bold_italics_font_size = 30
theme_override_font_sizes/mono_font_size = 30
text = "sdfsfdsfsdfsd"
scroll_active = false
script = ExtResource("7_gb3p3")
metadata/index = 3

[node name="option4" type="RichTextLabel" parent="TextInterface"]
visible = false
texture_filter = 1
layout_mode = 1
anchors_preset = -1
anchor_left = 1.529
anchor_top = 14.203
anchor_right = 27.235
anchor_bottom = 15.203
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(-152.16, 87.88)
theme_override_colors/default_color = Color(1, 1, 1, 1)
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 10
theme_override_fonts/normal_font = ExtResource("5_x5upw")
theme_override_fonts/bold_font = ExtResource("22_mme0b")
theme_override_fonts/italics_font = ExtResource("23_esx6h")
theme_override_fonts/bold_italics_font = ExtResource("5_bvye2")
theme_override_font_sizes/normal_font_size = 30
theme_override_font_sizes/bold_font_size = 30
theme_override_font_sizes/italics_font_size = 30
theme_override_font_sizes/bold_italics_font_size = 30
theme_override_font_sizes/mono_font_size = 30
text = "sdfsfdsfsdfsd"
script = ExtResource("7_gb3p3")
metadata/index = 4

[connection signal="death" from="enemyTest" to="UserInterface/Resources" method="_on_kill"]
[connection signal="playerOption" from="TextInterface/textbox" to="TextInterface/textbox/option_indicator" method="becomeActive"]
[connection signal="printOption" from="TextInterface/textbox" to="TextInterface/option1" method="setOption"]
[connection signal="printOption" from="TextInterface/textbox" to="TextInterface/option2" method="setOption"]
[connection signal="printOption" from="TextInterface/textbox" to="TextInterface/option3" method="setOption"]
[connection signal="printOption" from="TextInterface/textbox" to="TextInterface/option4" method="setOption"]
[connection signal="optionSelected" from="TextInterface/textbox/option_indicator" to="TextInterface/option1" method="_on_option_indicator_option_selected"]
[connection signal="optionSelected" from="TextInterface/textbox/option_indicator" to="TextInterface/option2" method="_on_option_indicator_option_selected"]
[connection signal="optionSelected" from="TextInterface/textbox/option_indicator" to="TextInterface/option3" method="_on_option_indicator_option_selected"]
[connection signal="optionSelected" from="TextInterface/textbox/option_indicator" to="TextInterface/option4" method="_on_option_indicator_option_selected"]
[connection signal="initialized" from="TextInterface/option1" to="TextInterface/textbox" method="checkChoicesInit"]
[connection signal="selectionMade" from="TextInterface/option1" to="TextInterface/textbox" method="processChoice"]
[connection signal="initialized" from="TextInterface/option2" to="TextInterface/textbox" method="checkChoicesInit"]
[connection signal="selectionMade" from="TextInterface/option2" to="TextInterface/textbox" method="processChoice"]
[connection signal="initialized" from="TextInterface/option3" to="TextInterface/textbox" method="checkChoicesInit"]
[connection signal="selectionMade" from="TextInterface/option3" to="TextInterface/textbox" method="processChoice"]
[connection signal="initialized" from="TextInterface/option4" to="TextInterface/textbox" method="checkChoicesInit"]
[connection signal="selectionMade" from="TextInterface/option4" to="TextInterface/textbox" method="processChoice"]

[editable path="Player"]
[editable path="Player/protagImportable"]
[editable path="Player/protagImportable/Armature/Skeleton3D/Amoray-Note1"]
